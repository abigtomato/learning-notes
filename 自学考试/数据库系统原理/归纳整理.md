# 1.数据库系统概述

## 1.1.数据库基本概念

* 数据的概念：数据是描述事物的符号记录，是指用物理符号记录下来的可以鉴别的信息；
* 数据的类型：
  * 文本数据：数字，字母，特殊符号，汉字；
  * 多媒体数据：视频，音频，图像。
* 信息的概念：信息就是对数据进行加工处理后获得的内容，信息是有价值的，数据是杂乱无章的；
* 数据库的概念：是长期存储在计算机中的，有组织，可共享的数据集合；
* 数据库中存储的数据特点：永久存储，有组织，可共享；
* 数据库管理系统的概念：专门用来建立和管理数据库的一套软件，介入系统软件和应用软件之间；
* 数据库管理系统的功能：
  * 数据定义：使用数据库定义语言DDL去创建表，视图，索引等，还可以删除和修改这些对象；
  * 数据操作：对数据库中的数据进行增删改查操作；
  * 数据的组织，存储和管理；
  * 数据库的创建维护：创建数据库，管理数据库的存储空间，备份和恢复，监视数据库的性能；
  * 数据库的运行管理功能：在数据库运行过程中，需要确保数据的安全性，完整性，并发控制以及故障恢复；
  * 其他功能。
* 数据库系统的概念：计算机中引入数据库技术之后的系统，包括：数据库，数据库管理系统，数据库管理员，用户，应用程序。

## 1.2.数据库管理技术的发展阶段

* 人工管理阶段的特点：
  * 特点是数据不保存；
  * 应用程序管理数据；
  * 数据是面向应用的，无共享性和独立性。
* 文件系统阶段的特点：
  * 实现了数据的逻辑结构和物理结构的分离，实现了数据的物理独立性；
  * 实现了数据的长久保存；
  * 实现了文件级别的数据共享；
  * 数据面向的是特定用户；
  * 该阶段没有实现对数据进行统一的管理和控制，所以数据冗余度大，共享性差，独立性差。
* 数据库系统阶段的特点：
  * 数据集成：数据集成是数据库管理的主要目的，可以降低数据的冗余度，提高数据的共享性；
  * 数据共享性好；
  * 数据冗余度低；
  * 数据的一致性；
  * 数据独立性高（逻辑独立性，物理独立性）；
  * 统一的管理和控制（安全性，完整性，并发控制，故障恢复）；
  * 减少应用程序的开发。

## 1.3.数据库系统的结构

* 三级模式：
  * 模式：
    * 也叫做逻辑模式或概念模式，是数据库中全体数据的逻辑结构和特征的描述；
    * 模式其实就是一套建库，建表等规则，一套数据库只额能有一个模式。
  * 外模式：
    * 也叫做子模式或用户模式，是数据库用户能够看见和操作的局部数据的逻辑结构和特征的描述，是与某一个应用有关的数据的逻辑表示；
    * 外模式是某个用户的数据视图，模式是所有用户的公共数据视图；
    * 一个数据库可以有多个外模式；
    * 在数据库中提供了DDL去定义外模式，其实就是定义视图。
  * 内模式：
    * 也叫做存储模式，是对数据库中数据的存储结构和存取方式的描述，也是数据在数据库中的内部表现形式；
    * 一个数据库中只能有一个内模式；
    * 提供了DDL定义内模式的相关内容：如索引。
* 三级模式结构的两层映像及其作用：
  * 外模式/模式的映像：
    * 建立的是外模式与模式间的对应关系，对于同一个模式可以有多个外模式，每个外模式与模式间都有外模式/模式映像；
    * 作用：当模式改变时，可以修改外模式/模式的映像，从而不用修改外模式，不用修改应用程序，保证了程序与数据的逻辑独立性。
  * 模式/内模式的映像：
    * 建立全局的逻辑结构和物理存储结构间的对应关系，一个数据库只有一种模式和内模式，所以模式/内模式映像也是唯一的；
    * 作用：当存储结构改变时，可以修改模式/内模型的映像，使模式不用发生改变，实现了数据与程序的物理独立性。
* 数据库系统的运行与应用结构：
  * C/S结构：客户端/服务器；
  * B/S结构：浏览器/服务器（使用方便，维护成本低）。

## 1.4.数据模型

* 模型：是对现实世界中事物的模拟和抽象，帮助人们更好的认识和理解客观存在的事物；
* 数据模型：是对现实世界中数据特征的抽象，描述的是数据的共性内容；
* 数据的特征：
  * 静态特征：数据类型，数据长度，数据取值范围；
  * 动态特征：对数据进行的一些符合规则的操作。
* 数据模型三要素：
  * 数据结构：数据的静态特征，数据对象的类型，数据对象的联系；
  * 数据操作：数据的动态特征，对数据的增删改查操作；
  * 数据约束：描述数据结构中数据间语法和语义的关联，取值范围，数据类型，是否为空。
* 数据从现实世界抽象到机器世界的过程：
  * 先将现实世界中的事物抽象为信息世界中的某一信息结构（对应于概念模型），既不依赖于计算机系统，也不依赖于数据库管理系统；
  * 然后将概念模型通过组织转换为机器世界中的某一数据库管理系统所支持的数据模型。
* 数据模型的分类：
  * 信息世界的基本概念：
    * 实体：客观存在的可相互区别的事物，如：学生，老师都是一个实体；
    * 属性：实体具有的某种特征，如：学生实体的属性就是学号，年龄，姓名，性别；
    * 码或键：可以用来唯一标识实体的属性集，如：学生实体的学号；
    * 域：属性的取值范围，如：性别分男女，分数0-100；
    * 实体型：用实体名和属性名的集合表示的同类实体，如：学生（学号、姓名、性别、年龄）；
    * 实体集：同类实体的集合，如：一个学生是实体，所有学生构成的集合就是实体集；
    * 联系：
      * 实体内的联系：指实体间各属性的关系，如：确定了学号，就可以知道该学生的姓名等其他信息。
      * 实体间的联系：一对一，一对多，多对多的联系。
  * 概念层数据模型（使用E-R图表示实体以及实体间的联系）是数据抽象级别的最高层，是现实世界对应于信息世界的建模，这种模型与计算机系统和数据库管理系统都无关，但是它容易向数据库管理系统所支持的逻辑结构转换：
    * 实体：矩形表示；
    * 属性：椭圆表示；
    * 联系：菱形表示；
    * 注：如果联系也存在属性，需要将属性表示出来，并使用无向边将属性与联系连接起来。
  * 逻辑层数据模型（逻辑模型）是数据抽象的中间层，是对数据整体逻辑结构的描述，既考虑用户容易理解，又考虑数据库容易实现：
    * 层次模型：
      * 使用树形结构去表示实体间的联系；
      * 特点：有且仅有一个根节点没有父节点；其他节点都有且仅有一个父节点；可以表示简单的实体间联系，但不适合表示复杂的联系。
    * 网状模型：
      * 使用网状结构去表示实体间的联系；
      * 特点：可以有多个结点没有父节点，一个节点可以有多个父节点；方便比表示复杂的实体间联系，但结构复杂不易实现。
    * 关系模型：
      * 使用二维表结构去表示实体间的联系；
      * 一对一联系，一对多联系，多对多联系。
    * 面向对象模型。
  * 物理层的数据模型（物理模型）：



# 2.关系数据库

## 2.1.关系数据库的概述

关系数据库是以关系模型作为数据的逻辑模型，以关系作为数据组织方式的一类数据库。

* 历史：
  * 1970年由IBM公司的CODD提出关系模型的概念；
  * 1972年提出了三大范式；
  * 1974年提出了BC范式。

* 数据库系统类型：
  * 实验系统：System R，Ingres
  * 商用系统：Oracle，DB2，SqlServer
  * 中小型数据库系统：MySql

## 2.2.关系数据模型

* 关系数据模型：关系数据库采用了关系数据模型作为逻辑层结构；关系数据结构，关系操作集合，关系完整性约束；
* 关系数据结构：关系数据结构指的就是关系，使用关系去表示实体间的联系；可以将关系看成是一个二维表，如学生表也叫做学生关系；
* 关系数据库中的基本术语：
  * 表：也叫做关系，是二维的数据结构，由表名，行，列组成，表名在数据库中必须唯一；
  * 关系：概念同表，一个关系逻辑上对应一个二维表，关系可以命名，关系的类型有基本表，视图表，查询表；
  * 列：也叫做属性或字段，存在列名（字段名，属性名），表中的属性个数叫做元或度；
  * 属性：概念同列，一列就是一个属性；
  * 行：也叫做元组或记录，表中的数据就是按行存储的；
  * 元组：概念同行，一行就是一个元组；
  * 分量：元组中的一个属性值就是一个分量；
  * 码或键：能用来唯一标识一个实体的属性集；
  * 超码或超键：如果一个关系的码移除某个属性后仍然是这个关系的码，那么这个码就叫做超码，如：学生表中（学号，姓名），（学号，姓名，年龄）；
  * 候选码或候选键：若一个关系的码移除某个属性后就不再是这个关系的码，那么这个码就叫做候选码，如：学生表中（学号），（姓名，年龄，地址，身高，体重，爱好）；
  * 主码或主键：若指定一个候选码来唯一标识一条记录，那么这个候选码就叫做主码。一个关系中主码只有一个，候选码可以有多个；
  * 全码或全键：若一个关系中的所有属性组成的集合是这个关系的主码，那么就称该主码为全码；
  * 主属性和非主属性：若一个关系中被包含在任意候选码中的属性，就叫做主属性，反之就是非主属性；
  * 外码或外键：若一个关系中存在不是这个关系的主码或候选码而是另一个关系的主码的属性，那么该属性就叫做该关系的外码；
  * 参照关系和被参照关系：以外码作为主码的关系称为被参照关系，外码所在的关系成为参照关系；
  * 域：指的是属性的取值范围；
  * 数据类型：标准中的每列都有数据类型，用于限制该列存放的数据；
  * 关系模式：在关系数据库中，关系模式是型，关系是值，关系模式是二维表的结构，关系是元组的集合。

## 2.3.关系数据库对关系的的限定

并不是所有的二维表都可以称为关系，需要满足如下条件：

* 每个属性都是不可以分解的；
* 每一个关系必须只有一个关系模式（二维表结构），每一个关系的属性的数据类型和属性个数是相对固定的；
* 同一个关系中候选码的值是不能完全相同的；
* 在关系中元组的顺序是可以任意交换的；
* 在关系中属性的顺序是可以任意交换的。

## 2.4.关系操作的集合

* 常用关系操作：

  * 查询：并，交，差，笛卡尔积，选择，投影，连接，除；
  * 更新：增，删，改。

* 关系操作的特点：关系操作是集合操作方式，操作对象和操作结果都是集合，一次一集合；

* 关系操作的语言分类：

  * 关系代数语言；
  * 关系演算语言（元组关系演算，域关系演算）；
  * 介于关系代数和关系演算语言之间的SQL（结构化查询语言）：
    * 数据定义语言（DDL）；
    * 数据操作语言（DML）；
    * 数据控制语言（DCL）。

* 关系数据语言的特点：

  * 具有完备的表达能力；
  * 能独立使用，也可以嵌入高级编程语言使用；
  * 功能强；
  * 是非过程化的集合操作语言。

* 关系代数：关系代数操作三要素：操作对象，操作符，操作结果。操作对象和结果都是关系，操作符分为专门的关系操作符和传统集合操作符：

  * 传统的集合操作（先假设有两个关系R1和R2）：

    * 并：R1，R2通过并运算产生新的关系R3，R3是由属于R1和R2的所有不同的元组所组成，即：R3 = R1 ∪ R2；
    * 差：R1，R2通过差运算产生新的关系R3，R3是由属于R1但不属于R2的元组所构成，即：R3 = R1 - R2；
    * 交：R1，R2通过交运算产生新的关系R3，R3是由既属于R1又属于R2的的元组所构成，即：R3 = R1 ∩ R2；
    * 笛卡尔积：R1为M元关系，R2为N元关系，R1和R2通过笛卡尔积运算产生新关系R3，此时R3是M+N元，M*N条记录，即：R3 = R1 × R2；
    * 注：在进行交，并，差运算时，要求两个关系必须具有相同的属性个数，且相应的属性具有相同的值域。

  * 专门的关系运算：

    * 选择：

      * 从指定的关系中去选择满足条件的若干元组，并组成一个新的关系；

      * F指的是条件表达式  R指的是关系名：
        $$
        σ_F(R)
        $$

      * 还可以表示为`SELECT 关系名 WHERE 条件`。

    * 投影：

      * 从指定的关系中选取指定的若干属性组成一个新的关系；

      * A指的是列名，R指的是关系名：
        $$
        π_A(R)
        $$
        
    * 还可以表示为`PROJECTION 关系名 (列名1,列名2,...)`；
      
    * 注：在做投影操作时，生成的新关系中不包含重复的元组。
      
    * 连接：

      * 将两个关系连接起来，从中选择满足条件的元组组成新的关系；
      * 表示方式：![](./assets/image-20200818174624712.png)
      * 还可以表示为`JOIN 关系1 AND 关系2 WHERE 条件 `；
      * 常用的连接：等值连接，自然连接；
      * 等值连接：比较运算符是 = ；
      * 自然连接是一种特殊的等值连接，进行等值连接的属性是相同的属性，且需要把结果中重复的列去除。

    * 除：即笛卡尔积的逆运算，R ÷ S，R和S代表参与运算的两个关系。在除运算中，若被除关系是m元关系，除关系是n元关系，则运算结果是m-n元关系。

      ![](./assets/20180702221327633.jpg)

       ![](./assets/20180702221337126.jpg)